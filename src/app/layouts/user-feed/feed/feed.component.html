 <div class="student_rht">
    <div #feedBlock>
        <cdk-virtual-scroll-viewport itemSize="200" class="viewport">
        <div class="custom_card media_card" routerLink="/myProfile" [queryParams]="{ post: 'create' }">
            <div class="tabs_wraper">
                <ul>
                    <li class="active" data-item="write-something"><img src="assets/images/icons/edit_icon.png" alt="edit">Write a Feed</li>
                </ul>
            </div>
            <div class="text_box" id="write-something">
                <textarea placeholder="Write Something.." id="writeSomething"></textarea>
            </div>
            <div class="upload_media media_box" id="upload-img">
                <input type="file" id="upload_img" class="d-none">
                <label for="upload_img">
                    <img src="assets/images/icons/uploadImg.png" alt="image">
                    Upload image
                </label>
            </div>
            <div class="upload_media media_box" id="upload-video">
                <input type="file" id="upload_vid" class="d-none">
                <label for="upload_vid">
                    <img src="assets/images/icons/upload_video.png" alt="video" class="mb-2">
                    Upload video
                </label>
            </div>
            <div class="custom_card_ftr">
                <p><span>Write a Question</span>  on tanito</p>
                <p><span id="charCount">0</span>/2000</p>
            </div>
        </div>
        <div class="custom_card custom_crd_padd" *ngIf="feeds.length == 0 && query">
            <h5>No Post Found!</h5>
        </div>
            <div class="custom_card custom_crd_padd feeds" *cdkVirtualFor="let feed of feeds | shuffleFeeds">
                <div class="follow_top d-flex align-items-center">
                    <div class="follow_lft">
                        <img [routerLink]="'/user/'+ feed.user_id" class="profile-img" [src]="feed.profile_img == null ? userAvatar : profilePath + feed.profile_img" [alt]="feed.username">
                    </div>
                    <div class="follow_rht">
                        <div class="d-flex align-items-center">
                            <h3 [routerLink]="feed.user_id == loggedUser.id ? '/myProfile' : '/user/'+feed.user_id">{{ feed.username }}</h3>
                            <img class="user-type" [src]="feed.usertype == 3 ? studentIcon : teacherIcon " alt="user type">
                        </div>
                        <p>{{ (feed.usertype == 3 ? "Student at ":"Teacher at ") +  feed.university }} &nbsp; | <span>{{ feed.created | postCreated }}</span></p>
                    </div>
                    <div class="option">
                        <button type="button" class="dots_btn" appShowMenu><img src="assets/images/icons/dots.png" alt="dots"></button>
                        <div class="dropdown-menu report my_account_dropmenu">
                            <ul>
                               <li><a (click)="reportModal(feed.id)">Report Post</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="follow_bdy">
                    <p> {{ feed.body }} </p>
                    <ul [hidden]="feed.tags.length == 0" class="hashtags">
                        <li *ngFor="let tag of feed.tags.split(',')">#{{ tag | lowercase }}</li>
                    </ul>
                    <img *ngIf="feed.image.length > 0" class="post-img" [src]="imageDirPath + feed.image">
                    <plyr *ngIf="feed.video.length > 0" style="display: block; max-width: 640px;" plyrTitle="Video 1" [plyrPlaysInline]="true" [plyrSources]="[{ src: videoDirPath + feed.video }]"></plyr>
                  </div>
                  <p class="subject d-block d-sm-none" [hidden]="feed.subject.length == 0"> {{ feed.subject | titlecase }}</p>
                  <div class="follow_ftr">
                    <div class="action-btn">
                        <button type="button" class="post-action-btn" [ngClass]="{ 'liked': isPostLiked(feed.likes) }" #likeBtn (click)="onLikePost(feed.id, likeType ? likeType : getLikeType(feed.likes), likeBtn, feed)">
                            <img [src]="checkLikeType(feed.likes)" alt="icon" />
                        </button>
                        <div class="follow_ftr react-btn-grp">
                            <button type="button" (click)="onLikePost(feed.id, 0, likeBtn, feed)">
                                <img src="assets/images/icons/like_icon.png" alt="icon" />
                            </button>
                            <button type="button" (click)="onLikePost(feed.id, 1, likeBtn, feed)">
                                <img src="assets/images/icons/lightbulb.png" alt="icon" />
                            </button>
                            <button type="button" (click)="onLikePost(feed.id, 2, likeBtn, feed)">
                                <img src="assets/images/icons/clap.png" alt="icon" />
                            </button>
                            <button type="button" (click)="onLikePost(feed.id, 3, likeBtn, feed)">
                                <img src="assets/images/icons/like.png" alt="icon" />
                            </button>
                        </div>
                    </div>
                    <span class="likes">{{ feed.likes.length }}</span>
                    <span class="view" (click)="onViewReaction(feed.id)"><i class="fa fa-eye" aria-hidden="true"></i></span>
                    <span class="subjects d-none d-sm-block" [hidden]="feed.subject.length == 0"> &nbsp; &nbsp; | &nbsp; &nbsp; {{ feed.subject | titlecase }}</span>
                    <div class="share-post">
                        <share-buttons [show]="5" [include]="['facebook','twitter','linkedin','pinterest','reddit','copy']" [url]="baseurl + '/#/post/' + feed.id"></share-buttons>
                        <button type="button" #shareBtn (click)="toggleShareGroup(shareBtn)" class="post-action-btn share-btn" data-toggle="modal" data-target="#report_mdl"><img src="assets/images/icons/share_icon.png" alt="icon" /></button>
                    </div>
                  </div>
            </div>
          </cdk-virtual-scroll-viewport>
    </div>
    <div *ngIf="feeds.length == 0 && !query">
        <app-users></app-users>
    </div>
</div>

<ng-template #viewReactions>
    <div class="modal_tanito">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal_body_top">
                    <h5>REACTIONS</h5>
                </div>
                <mat-tab-group>
                    <mat-tab>
                        <ng-template mat-tab-label>
                            All
                            <span class="badge badge-primary" *ngIf="reactionFetched">{{ totalUserReaction.length }}</span>
                        </ng-template>
                        <div class="d-flex align-items-center mb-4" *ngFor="let user of totalUserReaction">
                            <span class="profile_dp"><img [src]="profilePath + user.profile_img" [alt]="user.username"></span>
                            <h5>{{ user.username }}</h5>
                        </div>
                    </mat-tab>

                    <mat-tab>
                        <ng-template mat-tab-label>
                            <img src="assets/images/icons/ok.png" alt="reaction">
                            <span class="badge badge-primary ml-" *ngIf="reactionFetched">{{ okUserReaction.length }}</span>
                        </ng-template>
                        <div class="d-flex align-items-center mb-4" *ngFor="let user of okUserReaction">
                            <span class="profile_dp"><img [src]="profilePath + user.profile_img" [alt]="user.username"></span>
                            <h5>{{ user.username }}</h5>
                        </div>
                    </mat-tab>
                    
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <img src="assets/images/icons/lightbulb.png" alt="reaction"> 
                            <span class="badge badge-primary" *ngIf="reactionFetched">{{ innUserReaction.length }}</span>
                        </ng-template>
                        <div class="d-flex align-items-center mb-4" *ngFor="let user of innUserReaction">
                            <span class="profile_dp"><img [src]="profilePath + user.profile_img" [alt]="user.username"></span>
                            <h5>{{ user.username }}</h5>
                        </div>
                    </mat-tab>
                    
                    <mat-tab>
                        <ng-template mat-tab-label>
                            <img src="assets/images/icons/clap.png" alt="reaction">
                            <span class="badge badge-primary" *ngIf="reactionFetched">{{ clapUserReaction.length }}</span>
                        </ng-template>
                        <div class="d-flex align-items-center mb-4" *ngFor="let user of clapUserReaction">
                            <span class="profile_dp"><img [src]="profilePath + user.profile_img" [alt]="user.username"></span>
                            <h5>{{ user.username }}</h5>
                        </div>
                    </mat-tab>

                    <mat-tab>
                        <ng-template mat-tab-label>
                            <img src="assets/images/icons/like.png" alt="reaction">
                            <span class="badge badge-primary" *ngIf="reactionFetched">{{ goodUserReaction.length }}</span>
                        </ng-template>
                        <div class="d-flex align-items-center mb-4" *ngFor="let user of goodUserReaction">
                            <span class="profile_dp"><img [src]="profilePath + user.profile_img" [alt]="user.username"></span>
                            <h5>{{ user.username }}</h5>
                        </div>
                    </mat-tab>
                </mat-tab-group>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #reportPost>
    <div class="modal_tanito report_modal">
      <div class="modal-dialog">
        <div class="modal-content text-center">
          <div class="modal-header primary_bg">
            <h5 class="modal-title text-uppercase">Report Post</h5>
          </div>
          <div class="modal-body">
            <form>
                <div class="form-check" *ngFor="let reason of reportReason; let i = index">
                    <input class="form-check-input" (change)="selectedReason = reason" type="radio" name="reason" id="{{ 'reason' + - + i }}">
                    <label class="form-check-label" for="{{ 'reason' + - + i }}">
                      <h6>{{ reason }}</h6>
                    </label>
                </div>
                <textarea [(ngModel)]="specifiedReason"name="message" placeholder="Type your message.."></textarea>
                <p>lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, </p>
                <div class="button_box d-flex align-items-center justify-content-center">
                  <a href="index.php" class="back_to_home_btn mr-2">Back to Home</a>  
                  <button (click)="onReportProfile()" type="button" class="ml-2">Submit</button>  
                </div>
            </form>
          </div>
        </div>
      </div>
    </div>
</ng-template>


<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px', fullScreenBackdrop: true }"></ngx-loading>